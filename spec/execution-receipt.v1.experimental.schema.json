{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Execution Receipt (v1 Experimental)",
  "description": "Non-normative draft schema for v1 compatibility planning.",
  "type": "object",
  "required": [
    "schema_version",
    "artifact",
    "manifest_hash",
    "policy_hash",
    "bundle_hash",
    "inputs_hash",
    "outputs_hash",
    "runtime_version_digest",
    "result_digest",
    "caps_requested",
    "caps_granted",
    "caps_used",
    "result",
    "runtime",
    "started_at",
    "finished_at",
    "timestamp_strategy",
    "receipt_hash"
  ],
  "additionalProperties": false,
  "properties": {
    "schema_version": {
      "type": "string",
      "const": "1.0.0-draft"
    },
    "artifact": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "manifest_hash": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "policy_hash": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "bundle_hash": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "inputs_hash": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "outputs_hash": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "runtime_version_digest": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "result_digest": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    },
    "caps_requested": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "caps_granted": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "caps_used": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "result": {
      "type": "object",
      "required": ["status", "code"],
      "additionalProperties": false,
      "properties": {
        "status": {
          "type": "string",
          "enum": ["success", "failure"]
        },
        "code": {
          "type": "string",
          "minLength": 1
        },
        "message": {
          "type": "string"
        }
      }
    },
    "runtime": {
      "type": "object",
      "required": ["name", "version"],
      "additionalProperties": false,
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "profile": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "started_at": {
      "type": "integer",
      "minimum": 0
    },
    "finished_at": {
      "type": "integer",
      "minimum": 0
    },
    "timestamp_strategy": {
      "type": "string",
      "enum": ["local_untrusted_unix_seconds"]
    },
    "attestations": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["type", "value"],
        "additionalProperties": false,
        "properties": {
          "type": {
            "type": "string",
            "minLength": 1
          },
          "value": {
            "type": "string",
            "minLength": 1
          }
        }
      }
    },
    "receipt_hash": {
      "type": "string",
      "pattern": "^sha256:[0-9a-f]{64}$"
    }
  }
}
